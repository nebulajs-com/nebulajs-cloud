(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ebe5df7"],{"2e05":function(t,e,o){},"4e02":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return n})),o.d(e,"f",(function(){return r})),o.d(e,"d",(function(){return a})),o.d(e,"a",(function(){return c})),o.d(e,"e",(function(){return u}));var s=o("0c6d");function i(t){return Object(s["a"])({url:"/cloud/app/app-process-group",method:"get",params:t})}function n(t){return Object(s["a"])({url:"admin/form/group/sort",method:"put",data:t})}function r(t,e){return Object(s["a"])({url:"admin/form/group",method:e,params:t})}function a(t){}function c(t){return Object(s["a"])({url:"/cloud/app/app-process-def/"+t,method:"get"})}function u(t){return Object(s["a"])({url:"/cloud/app/app-process-def/wflow",method:"post",data:t})}},"6ec6":function(t,e,o){"use strict";o("2e05")},"7f4c":function(t,e,o){"use strict";o.r(e);o("14d9");var s=function(){var t=this,e=t._self._c;return e("div",{ref:"panel",staticClass:"from-panel"},[e("div",{staticClass:"from-title"},[e("el-button",{staticStyle:{"margin-right":"15px"},attrs:{icon:"el-icon-back",type:"info",size:"mini",circle:"",plain:""},on:{click:function(e){return t.$router.push("/")}}}),e("span",[t._v("流程面板")]),e("span",{staticStyle:{color:"#c75450","margin-left":"20px"}},[t._v("📢 大家要体验的话，尽量使用已有的分组和流程进行编辑，不要随意新建，数据有点乱哈，谢谢了❤")]),e("div",[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:t.newProcess}},[t._v("新建表单")]),e("el-button",{attrs:{icon:"el-icon-plus",size:"mini"},on:{click:t.addGroup}},[t._v("新建分组")])],1)],1),e("draggable",{attrs:{list:t.groups,group:"group",handle:".el-icon-rank",filter:".undrag",options:{animation:300,sort:!0,scroll:!0,chosenClass:"choose"}},on:{start:function(e){t.groupsSort=!0},end:t.groupSort}},t._l(t.groups,(function(o,s){return e("div",{directives:[{name:"show",rawName:"v-show",value:o.id>1||o.items.length>0,expression:"group.id > 1 || group.items.length > 0 "}],key:s,class:{"form-group":!0,undrag:0===o.id||void 0===o.id}},[e("div",{staticClass:"form-group-title"},[e("span",[t._v(t._s(o.name))]),e("span",[t._v("("+t._s(o.items.length)+")")]),e("i",{staticClass:"el-icon-rank",attrs:{title:"长按拖动可对分组排序"}}),0!==o.id&&void 0!==o.id?e("div",[e("el-dropdown",[e("el-button",{attrs:{type:"text",icon:"el-icon-setting"}},[t._v("编辑分组")]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{icon:"el-icon-edit-outline"},nativeOn:{click:function(e){return t.editGroup(o)}}},[t._v("修改名称")]),e("el-dropdown-item",{attrs:{icon:"el-icon-delete"},nativeOn:{click:function(e){return t.delGroup(o)}}},[t._v("删除分组")])],1)],1)],1):t._e()]),e("draggable",{directives:[{name:"show",rawName:"v-show",value:!t.groupsSort,expression:"!groupsSort"}],staticStyle:{width:"100%","min-height":"25px"},attrs:{list:o.items,group:"from",filter:".undrag",options:{animation:300,delay:200,chosenClass:"choose",scroll:!0,sort:!0}},on:{end:t.groupSort}},t._l(o.items,(function(s,i){return e("div",{key:i,class:{"form-group-item":!0,undrag:s.isStop},attrs:{title:"长按0.5S后可拖拽表单进行排序"}},[e("div",[e("i",{class:s.logo.icon,style:"background: "+s.logo.background}),e("span",[t._v(t._s(s.formName))]),e("br")]),e("div",{staticClass:"desp"},[t._v(t._s(s.remark))]),e("div",[e("span",[t._v("最后更新时间："+t._s(s.updated))])]),e("div",[e("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline",size:"mini"},on:{click:function(e){return t.editFrom(s,o)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"text",icon:s.isStop?"el-icon-check":"el-icon-close",size:"mini"},on:{click:function(e){return t.stopFrom(s)}}},[t._v(" "+t._s(s.isStop?"启用":"停用")+" ")]),s.isStop?e("el-button",{attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.moveFrom(s)}}},[t._v("删除 ")]):e("el-popover",{staticStyle:{"margin-left":"10px"},attrs:{placement:"left",trigger:"click",width:"400"},on:{show:function(e){t.moveSelect}}},[e("el-radio-group",{attrs:{size:"mini"},model:{value:t.moveSelect,callback:function(e){t.moveSelect=e},expression:"moveSelect"}},t._l(t.groups,(function(s){return e("el-radio",{directives:[{name:"show",rawName:"v-show",value:s.id>1,expression:"g.id > 1"}],key:s.id,staticStyle:{margin:"10px"},attrs:{label:s.id,border:"",disabled:s.id===o.id}},[t._v(t._s(s.name))])})),1),e("div",{staticStyle:{"text-align":"right",margin:"0"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.moveFrom(s)}}},[t._v("提交")])],1),e("el-button",{attrs:{slot:"reference",type:"text",icon:"el-icon-s-promotion",size:"mini"},slot:"reference"},[t._v("移动")])],1)],1)])})),0),void 0===o.items||0===o.items.length?e("div",{staticStyle:{"text-align":"center"}},[e("el-button",{staticStyle:{"padding-top":"0"},attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(e){return t.newProcess(o.id)}}},[t._v("创建新表单")])],1):t._e()],1)})),0)],1)},i=[],n=o("b76a"),r=o.n(n),a=o("4e02"),c={name:"FormsPanel",components:{draggable:r.a},data(){return{moveSelect:"",visible:!1,groupsSort:!1,groups:[]}},mounted(){this.getGroups()},methods:{getGroups(){Object(a["b"])().then(t=>{this.groups=t.data,this.groups.forEach(t=>{t.items.forEach(t=>{t.logo=JSON.parse(t.logo)})})}).catch(t=>this.$message.error("获取分组异常"))},newProcess(t){this.$store.commit("setTemplate",this.getTemplateData()),this.$store.commit("setIsEdit",!1),this.$router.push("/admin/design?groupId="+t)},groupSort(){this.groupsSort=!1,Object(a["c"])(this.groups).then(t=>{this.$message.success(t.data),this.getGroups()}).catch(t=>{this.getGroups(),this.$message.error(t.response.data)})},addGroup(){this.$prompt("请输入要添加的组名","新的分组名",{confirmButtonText:"提交",cancelButtonText:"取消",inputPattern:/^[\u4E00-\u9FA5A-Za-z0-9\\-]{1,30}$/,inputErrorMessage:"分组名不能为空且长度小于30",inputPlaceholder:"请输入分组名"}).then(({value:t})=>{Object(a["f"])({name:t},"post").then(t=>{this.$message.success(t.data),this.getGroups()}).catch(t=>this.$message.error(t.response.data))})},delGroup(t){this.$confirm("删除分组并不会删除表单，表单将会被转移到 “其他” 分组，确定要删除分组 "+t.name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(a["f"])({id:t.id},"delete").then(t=>{this.$message.success(t.data),this.getGroups()}).catch(t=>this.$message.error(t.response.data))})},editGroup(t){this.$prompt("请输入新的组名","修改分组名",{confirmButtonText:"提交",cancelButtonText:"取消",inputPattern:/^[\u4E00-\u9FA5A-Za-z0-9\\-]{1,30}$/,inputErrorMessage:"分组名不能为空且长度小于30",inputPlaceholder:"请输入分组名",inputValue:t.name}).then(({value:e})=>{Object(a["f"])({id:t.id,name:e},"put").then(t=>{this.$message.success(t.data),this.getGroups()}).catch(t=>this.$message.error(t.response.data))})},updateForm(t,e){Object(a["d"])({templateId:t.id,type:e}).then(t=>{this.$message.success(t.data),this.getGroups()}).catch(t=>this.$message.error(t.response.data))},getTemplateData(t,e){return t},editFrom(t,e){this.$router.push("/admin/design?code="+t.formId)},stopFrom(t){let e=t.isStop?" 启用后将会进入 “其他” 分组，是否继续？":" 停用后将会被转移到 “已停用” 分组，您可以再次启用或者删除它，是否继续?";this.$confirm(t.name+e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.updateForm(t,t.isStop?"using":"stop")})},moveFrom(t){if(t.isStop)this.$confirm("您确定要删除表单 "+t.name+" 吗，删除后无法恢复，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.updateForm(t,"delete")});else{if(null===this.moveSelect||""===this.moveSelect)return void this.$message.error("请选择分组");Object(a["d"])({templateId:t.id,type:"move",groupId:this.moveSelect}).then(t=>{this.$message.success(t.data),this.getGroups(),this.moveSelect=null}).catch(t=>this.$message.error(t.response.data))}}}},u=c,l=(o("6ec6"),o("2877")),p=Object(l["a"])(u,s,i,!1,null,"e0a606c2",null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-3ebe5df7.3e415f14.js.map