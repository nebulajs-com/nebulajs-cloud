(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45791fda"],{"00ee":function(e,t,s){"use strict";var i=s("b622"),a=i("toStringTag"),r={};r[a]="z",e.exports="[object z]"===String(r)},"0cb2":function(e,t,s){"use strict";var i=s("e330"),a=s("7b0b"),r=Math.floor,l=i("".charAt),n=i("".replace),c=i("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,s,i,p,h){var u=s+e.length,g=i.length,f=d;return void 0!==p&&(p=a(p),f=o),n(h,f,(function(a,n){var o;switch(l(n,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,s);case"'":return c(t,u);case"<":o=p[c(n,1,-1)];break;default:var d=+n;if(0===d)return a;if(d>g){var h=r(d/10);return 0===h?a:h<=g?void 0===i[h-1]?l(n,1):i[h-1]+l(n,1):a}o=i[d-1]}return void 0===o?"":o}))}},"21c7":function(e,t,s){"use strict";s("3d6c")},"24fd":function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"c",(function(){return r})),s.d(t,"b",(function(){return l}));var i=s("0c6d");function a({deptId:e,type:t}){const s={parentId:{}};return e?s.parentId["eq"]=e:s.parentId["empty"]="true",Object(i["a"])({url:"/cloud/app/app-org",method:"get",params:{filter:JSON.stringify(s)}})}function r({orgIds:e,roleIds:t,name:s}){const a={orgs:{id:{in:e||""}},roles:{id:{in:t||""}},name:{like:s||""}};return e&&(a["orgs"]={id:{in:e}}),t&&(a["roles"]={id:{in:t}}),s&&(a["name"]={like:s}),Object(i["a"])({url:"/cloud/app/app-user",method:"get",params:{filter:JSON.stringify(a)}})}function l(e){return Object(i["a"])({url:"/cloud/app/app-role",method:"get",params:e})}},"3d6c":function(e,t,s){},"44e7":function(e,t,s){"use strict";var i=s("861d"),a=s("c6b6"),r=s("b622"),l=r("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[l])?!!t:"RegExp"===a(e))}},"577e":function(e,t,s){"use strict";var i=s("f5df"),a=String;e.exports=function(e){if("Symbol"===i(e))throw new TypeError("Cannot convert a Symbol value to a string");return a(e)}},"5b81":function(e,t,s){"use strict";var i=s("23e7"),a=s("c65b"),r=s("e330"),l=s("1d80"),n=s("1626"),c=s("7234"),o=s("44e7"),d=s("577e"),p=s("dc4a"),h=s("90d8"),u=s("0cb2"),g=s("b622"),f=s("c430"),v=g("replace"),m=TypeError,b=r("".indexOf),y=r("".replace),k=r("".slice),S=Math.max;i({target:"String",proto:!0},{replaceAll:function(e,t){var s,i,r,g,x,w,_,C,O,I,A=l(this),L=0,N="";if(!c(e)){if(s=o(e),s&&(i=d(l(h(e))),!~b(i,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(r=p(e,v),r)return a(r,e,A,t);if(f&&s)return y(d(A),e,t)}g=d(A),x=d(e),w=n(t),w||(t=d(t)),_=x.length,C=S(1,_),O=b(g,x);while(-1!==O)I=w?d(t(x,O,g)):u(x,g,O,[],void 0,t),N+=k(g,L,O)+I,L=O+_,O=O+C>g.length?-1:b(g,x,O+C);return L<g.length&&(N+=k(g,L)),N}})},"65b7":function(e,t,s){"use strict";s("b39e")},"709c":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("w-dialog",{attrs:{border:!1,closeFree:"",width:"800px",title:e.title},on:{ok:e.selectOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("div",{staticClass:"picker"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"candidate"},[t("div",[t("ellipsis",{staticStyle:{height:"18px",color:"#8c8c8c",padding:"7px 0"},attrs:{hoverTip:"",row:1,content:e.deptStackStr}},[t("i",{staticClass:"el-icon-office-building",attrs:{slot:"pre"},slot:"pre"})]),t("div",[t("el-checkbox",{attrs:{disabled:!e.multiple},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.deptStack.length>0,expression:"deptStack.length > 0"}],staticClass:"top-dept",on:{click:e.beforeNode}},[e._v("上一级")])],1)],1),t("div",{staticClass:"org-items"},[t("el-empty",{directives:[{name:"show",rawName:"v-show",value:0===e.orgs.length,expression:"orgs.length === 0"}],attrs:{"image-size":100,description:"似乎没有数据"}}),e._l(e.orgs,(function(s,i){return t("div",{key:i,class:e.orgItemClass(s),on:{click:function(t){return e.selectChange(s,"dept")}}},[t("el-checkbox",{attrs:{value:s.selected,disabled:e.disableDept(s)}}),t("div",{staticStyle:{display:"flex","align-items":"center",flex:"1"}},[t("i",{staticClass:"el-icon-folder-opened"}),t("span",{staticClass:"name"},[e._v(e._s(s.name))]),t("span",{class:"next-dept"+(s.selected?"-disable":""),on:{click:function(t){return t.stopPropagation(),e.nextNode(s)}}},[t("i",{staticClass:"iconfont icon-map-site"}),e._v("下级 ")])])],1)}))],2)]),t("div",{staticClass:"users"},[t("div",{staticClass:"search-wrapper"},[t("el-input",{staticClass:"search-input",attrs:{size:"small",clearable:"",placeholder:"搜索人员，姓名模糊搜索","prefix-icon":"el-icon-search"},on:{input:e.searchUser},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),t("div",{staticClass:"org-items"},[t("el-empty",{directives:[{name:"show",rawName:"v-show",value:0===e.searchUserList.length,expression:"searchUserList.length === 0"}],attrs:{"image-size":100,description:"似乎没有数据"}}),e._l(e.searchUserList,(function(s,i){return t("div",{key:i,class:e.orgItemClass(s),on:{click:function(t){return e.selectChange(s,"user")}}},[t("el-checkbox",{attrs:{value:s.selected,disabled:e.disableDept(s)}}),t("div",{staticStyle:{display:"flex","align-items":"center"}},[e.$isNotEmpty(s.avatar)?t("el-avatar",{attrs:{size:35,src:s.avatar}}):e._e(),t("span",{staticClass:"name"},[e._v(e._s(s.name||s.login))])],1)],1)}))],2)]),t("div",{staticClass:"selected"},[t("div",{staticClass:"count"},[t("span",[e._v("已选 "+e._s(e.select.length)+" 项")]),t("span",{on:{click:e.clearSelected}},[e._v("清空")])]),t("div",{staticClass:"org-items",staticStyle:{height:"350px"}},[t("el-empty",{directives:[{name:"show",rawName:"v-show",value:0===e.select.length,expression:"select.length === 0"}],attrs:{"image-size":100,description:"请点击左侧列表选择数据"}}),e._l(e.select,(function(s,i){return t("div",{key:i,class:e.orgItemClass(s)},["dept"===s.type?t("div",[t("i",{staticClass:"el-icon-folder-opened"}),t("span",{staticClass:"name",staticStyle:{position:"static"}},[e._v(e._s(s.name))])]):"user"===s.type?t("div",{staticStyle:{display:"flex","align-items":"center"}},[e.$isNotEmpty(s.avatar)?t("el-avatar",{attrs:{size:35,src:s.avatar}}):t("span",{staticClass:"avatar"},[e._v(e._s(e.getShortName(s.name)))]),t("span",{staticClass:"name"},[e._v(e._s(s.name||s.login))])],1):t("div",[t("i",{staticClass:"iconfont icon-bumen"}),t("span",{staticClass:"name"},[e._v(e._s(s.name))])]),t("i",{staticClass:"el-icon-close",on:{click:function(t){return e.noSelected(i)}}})])}))],2)])])])},a=[],r=(s("14d9"),s("5b81"),s("24fd")),l={name:"OrgPicker",components:{},props:{title:{default:"请选择",type:String},type:{default:"org",type:String},multiple:{default:!1,type:Boolean},selected:{default:()=>[],type:Array}},data(){return{visible:!1,loading:!1,checkAll:!1,nowDeptId:null,isIndeterminate:!1,searchUserList:[],nodes:[],select:[],search:"",deptStack:[]}},computed:{deptStackStr(){return String(this.deptStack.map(e=>e.name)).replaceAll(","," > ")},orgs(){return this.nodes}},methods:{show(){this.visible=!0,this.init(),this.getOrgList()},orgItemClass(e){return{"org-item":!0,"org-dept-item":"dept"===e.type,"org-user-item":"user"===e.type}},disableDept(e){return"user"===this.type&&"dept"===e.type},getOrgList(){this.loading=!0,Object(r["a"])({deptId:this.nowDeptId,type:this.type}).then(e=>(this.loading=!1,this.nodes=e.data,Object(r["c"])({orgIds:this.nowDeptId}))).then(e=>{this.searchUserList=e.data,this.selectToLeft()}).catch(e=>{this.loading=!1,this.$message.error(e.response.data)})},getShortName(e){return e?e.length>2?e.substring(1,3):e:"**"},searchUser(){let e=this.search.trim();this.searchUserList=[],this.loading=!0,Object(r["c"])({name:e}).then(e=>{this.loading=!1,this.searchUserList=e.data.map(e=>(e.userId=e.id,e.id=e.login,e)),this.selectToLeft()}).catch(e=>{this.loading=!1,this.$message.error("接口异常")})},selectToLeft(){this.select=Object.assign([],this.selected),this.nodes.forEach(e=>{this.select.filter(e=>"dept"===e.type).map(e=>e.id).includes(e.id)?e.selected=!0:e.selected=!1}),this.searchUserList.forEach(e=>{this.select.filter(e=>"user"===e.type).map(e=>e.id).includes(e.id)?e.selected=!0:e.selected=!1})},selectChange(e,t){if(e.selected){this.checkAll=!1;for(let t=0;t<this.select.length;t++)if(this.select[t].id===e.id){this.select.splice(t,1);break}e.selected=!1}else if(!this.disableDept(e)){e.selected=!0,e.type=t;let s="dept"===t?this.nodes:this.searchUserList;this.multiple||s.forEach(t=>{e.id!==t.id&&(t.selected=!1)}),"dept"===e.type?this.multiple?this.select.unshift(e):this.select=[e]:this.multiple?this.select.push(e):this.select=[e]}},noSelected(e){let t=this.nodes;for(let s=0;s<2;s++){for(let s=0;s<t.length;s++)if(t[s].id===this.select[e].id){t[s].selected=!1,this.checkAll=!1;break}t=this.searchUserList}this.select.splice(e,1)},handleCheckAllChange(){this.nodes.forEach(e=>{if(this.checkAll)e.selected||this.disableDept(e)||(e.selected=!0,this.select.push(e));else{e.selected=!1;for(let t=0;t<this.select.length;t++)if(this.select[t].id===e.id){this.select.splice(t,1);break}}})},nextNode(e){this.nowDeptId=e.id,this.deptStack.push(e),this.getOrgList()},beforeNode(){0!==this.deptStack.length&&(this.deptStack.length<2?this.nowDeptId=null:this.nowDeptId=this.deptStack[this.deptStack.length-2].id,this.deptStack.splice(this.deptStack.length-1,1),this.getOrgList())},recover(){this.select=[],this.nodes.forEach(e=>e.selected=!1)},selectOk(){this.$emit("ok",Object.assign([],this.select.map(e=>({id:e.id,name:e.name||e.login,type:e.type,code:"dept"===e.type?e.code:null,login:"user"===e.type?e.login:null})))),this.visible=!1,this.recover()},clearSelected(){this.$confirm("您确定要清空已选中的项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.recover()})},close(){this.$emit("close"),this.recover()},init(){this.checkAll=!1,this.nowDeptId=null,this.deptStack=[],this.nodes=[],this.selectToLeft()}}},n=l,c=(s("21c7"),s("2877")),o=Object(c["a"])(n,i,a,!1,null,"256ffd70",null);t["a"]=o.exports},"86c3":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"max-width":"350px"}},["DESIGN"===e.mode?t("div",[t("el-button",{attrs:{disabled:"",icon:"el-icon-user",type:"primary",size:"mini",round:""}},[e._v("选择人员")]),t("span",{staticClass:"placeholder"},[e._v(" "+e._s(e.placeholder))])],1):t("div",[t("el-button",{attrs:{icon:"el-icon-user",type:"primary",size:"mini",round:""},on:{click:function(t){return e.$refs.orgPicker.show()}}},[e._v("选择人员")]),t("org-picker",{ref:"orgPicker",attrs:{type:"user",multiple:e.multiple,selected:e._value},on:{ok:e.selected}}),t("span",{staticClass:"placeholder"},[e._v(" "+e._s(e.placeholder))]),t("div",{staticStyle:{"margin-top":"5px"}},e._l(e._value,(function(s,i){return t("el-tag",{staticStyle:{margin:"5px"},attrs:{size:"mini",closable:""},on:{close:function(t){return e.delDept(i)}}},[e._v(e._s(s.name))])})),1)],1)])},a=[],r=s("8f73"),l=s("709c"),n={mixins:[r["a"]],name:"DeptPicker",components:{OrgPicker:l["a"]},props:{value:{type:Array,default:()=>[]},placeholder:{type:String,default:"请选择人员"},multiple:{type:Boolean,default:!1}},data(){return{showOrgSelect:!1}},methods:{selected(e){this.showOrgSelect=!1,this._value=e},delDept(e){this._value.splice(e,1)}}},c=n,o=(s("65b7"),s("2877")),d=Object(o["a"])(c,i,a,!1,null,"5198b846",null);t["default"]=d.exports},"8f73":function(e,t,s){"use strict";t["a"]={props:{mode:{type:String,default:"DESIGN"},required:{type:Boolean,default:!1}},data(){return{}},computed:{_value:{get(){return this.value},set(e){this.$emit("input",e)}}}}},"90d8":function(e,t,s){"use strict";var i=s("c65b"),a=s("1a2d"),r=s("3a9b"),l=s("ad6d"),n=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in n||a(e,"flags")||!r(n,e)?t:i(l,e)}},ad6d:function(e,t,s){"use strict";var i=s("825a");e.exports=function(){var e=i(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},b39e:function(e,t,s){},f5df:function(e,t,s){"use strict";var i=s("00ee"),a=s("1626"),r=s("c6b6"),l=s("b622"),n=l("toStringTag"),c=Object,o="Arguments"===r(function(){return arguments}()),d=function(e,t){try{return e[t]}catch(s){}};e.exports=i?r:function(e){var t,s,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(s=d(t=c(e),n))?s:o?r(t):"Object"===(i=r(t))&&a(t.callee)?"Arguments":i}}}]);
//# sourceMappingURL=chunk-45791fda.85819e51.js.map