(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4594095f"],{"11bb":function(e,t,n){"use strict";n("8fc1")},"2b36":function(e,t,n){"use strict";var s=function(){var e=this,t=e._self._c;return t("el-form",{ref:"form",staticClass:"process-form",attrs:{"label-position":"top",rules:e.rules,model:e._value}},e._l(e.forms,(function(n,s){return"SpanLayout"!==n.name&&"Description"!==n.name?t("el-form-item",{key:n.name+s,attrs:{prop:n.id,label:n.title}},[t("form-design-render",{ref:"sub-item_"+n.id,refInFor:!0,attrs:{mode:"PC",config:n},model:{value:e._value[n.id],callback:function(t){e.$set(e._value,n.id,t)},expression:"_value[item.id]"}})],1):t("form-design-render",{ref:"span-layout",attrs:{mode:"PC",config:n},model:{value:e._value,callback:function(t){e._value=t},expression:"_value"}})})),1)},a=[],r=n("d16b"),i={name:"FormRender",components:{FormDesignRender:r["a"]},props:{forms:{type:Array,default:()=>[]},value:{type:Object,default:()=>({})}},data(){return{rules:{}}},created(){this.loadFormConfig(this.forms)},computed:{_value:{get(){return this.value},set(e){this.$emit("input",e)}}},methods:{validate(e){let t=!0;this.$refs.form.validate(n=>{if(t=n,n)for(let e=0;e<this.forms.length;e++)if("TableList"===this.forms[e].name){let n=this.$refs["sub-item_"+this.forms[e].id];if(n&&Array.isArray(n)&&n.length>0&&(n[0].validate(e=>{t=e}),!t))break}e(t)})},loadFormConfig(e){e.forEach(e=>{"SpanLayout"===e.name?this.loadFormConfig(e.props.items):(this.$set(this._value,e.id,this.value[e.id]),e.props.required&&this.$set(this.rules,e.id,[{type:"Array"===e.valueType?"array":void 0,required:!0,message:"请填写"+e.title,trigger:"blur"}]))})}}},o=i,l=(n("71fa"),n("2877")),c=Object(l["a"])(o,s,a,!1,null,"3da7fc04",null);t["a"]=c.exports},"4e02":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return c}));var s=n("0c6d");function a(e){return Object(s["a"])({url:"/cloud/app/app-process-group",method:"get",params:e})}function r(e){return Object(s["a"])({url:"admin/form/group/sort",method:"put",data:e})}function i(e,t){return Object(s["a"])({url:"admin/form/group",method:t,params:e})}function o(e){}function l(e){return Object(s["a"])({url:"/cloud/app/app-process-def/"+e,method:"get"})}function c(e){return Object(s["a"])({url:"/cloud/app/app-process-def/wflow",method:"post",data:e})}},5372:function(e,t,n){},"71fa":function(e,t,n){"use strict";n("5372")},"862c":function(e,t,n){"use strict";n("da65")},"8fc1":function(e,t,n){},d16b:function(e,t,n){"use strict";var s=function(){var e=this,t=e._self._c;return t(e.config.name,e._b({ref:"form",tag:"component",attrs:{mode:e.mode},model:{value:e._value,callback:function(t){e._value=t},expression:"_value"}},"component",e.config.props,!1))},a=[];let r=()=>n.e("chunk-26c5db12").then(n.bind(null,"b28d")),i=()=>n.e("chunk-76d1ec8f").then(n.bind(null,"cf45")),o=()=>n.e("chunk-bbc41c94").then(n.bind(null,"5cb6")),l=()=>n.e("chunk-790652fa").then(n.bind(null,"d158")),c=()=>n.e("chunk-8b173cd0").then(n.bind(null,"0d29")),u=()=>n.e("chunk-c0be42b4").then(n.bind(null,"412b")),d=()=>n.e("chunk-4684e5ce").then(n.bind(null,"f89a")),m=()=>n.e("chunk-2d279333").then(n.bind(null,"4f98")),f=()=>n.e("chunk-ff757d9a").then(n.bind(null,"77aa")),p=()=>n.e("chunk-551d172a").then(n.bind(null,"db9e")),h=()=>n.e("chunk-1b91adc2").then(n.bind(null,"023d")),b=()=>n.e("chunk-2d0f04df").then(n.bind(null,"9c98")),v=()=>n.e("chunk-2d0e4c53").then(n.bind(null,"9248")),g=()=>n.e("chunk-534868ee").then(n.bind(null,"f13b")),k=()=>n.e("chunk-45791fda").then(n.bind(null,"86c3")),_=()=>n.e("chunk-2d0e9937").then(n.bind(null,"8db7")),I=()=>Promise.all([n.e("chunk-4a5f46a6"),n.e("chunk-57672512")]).then(n.bind(null,"918a")),y=()=>Promise.all([n.e("chunk-4a5f46a6"),n.e("chunk-546b6b7a")]).then(n.bind(null,"7ca0"));var w={TextInput:r,NumberInput:i,AmountInput:o,TextareaInput:l,SelectInput:c,MultipleSelect:u,DateTime:d,DateTimeRange:m,UserPicker:k,DeptPicker:g,Description:f,FileUpload:h,ImageUpload:p,MoneyInput:v,Location:b,SignPanel:_,SpanLayout:I,TableList:y},x={name:"FormRender",components:w,props:{mode:{type:String,default:"DESIGN"},value:{default:void 0},config:{type:Object,default:()=>({})}},computed:{_value:{get(){return this.value},set(e){this.$emit("input",e)}}},data(){return{}},methods:{validate(e){this.$refs.form.validate(e)}}},L=x,F=n("2877"),O=Object(F["a"])(L,s,a,!1,null,"495b63a5",null);t["a"]=O.exports},d43f:function(e,t,n){"use strict";n.r(t);n("14d9");var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"workspace"},[t("el-button",{staticClass:"back",attrs:{icon:"el-icon-back",type:"info",size:"mini",plain:""},on:{click:function(t){return e.$router.push("/")}}},[e._v("返回主页 ")]),t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",{attrs:{label:"审批列表"}},[t("el-row",{staticStyle:{"margin-bottom":"20px"}},[t("el-col",{attrs:{xs:12,sm:10,md:8,lg:6,xl:4}},[t("el-input",{attrs:{size:"medium",placeholder:"搜索表单",clearable:""},model:{value:e.formList.inputs,callback:function(t){e.$set(e.formList,"inputs",t)},expression:"formList.inputs"}},[t("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1)],1),t("el-collapse",{directives:[{name:"show",rawName:"v-show",value:""===e.formList.inputs,expression:"formList.inputs === ''"}],model:{value:e.actives,callback:function(t){e.actives=t},expression:"actives"}},e._l(e.formList.list,(function(n,s){return t("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:n.items.length>0&&n.id>0,expression:"group.items.length > 0 && group.id > 0"}],key:s,attrs:{title:n.name,name:n.name}},[t("div",e._l(n.items,(function(n,s){return t("div",{key:s,staticClass:"form-item",on:{click:function(t){return e.enterItem(n)}}},[t("i",{class:n.logo.icon,style:"background: "+n.logo.background}),t("div",[t("ellipsis",{attrs:{"hover-tip":"",content:n.formName}}),t("span",[e._v("发起审批")])],1)])})),0)])})),1),t("div",[e._l(e.formList.searchResult,(function(n,s){return t("div",{key:s,staticClass:"form-item",on:{click:function(t){return e.enterItem(n)}}},[t("i",{class:n.icon,style:"background: "+n.background}),t("div",[t("span",[e._v(e._s(n.formName))]),t("span",[e._v("发起审批")])])])})),t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.formList.searchResult.length&&""!==e.formList.inputs,expression:"formList.searchResult.length === 0 && formList.inputs !== ''"}],staticClass:"no-data"},[e._v(" 没有找到相关的表单 😥 ")])],2)],1),t("el-tab-pane",{attrs:{label:"待我处理(3)"}},[t("div",{staticClass:"no-data"},[e._v("暂无数据 😀")])]),t("el-tab-pane",{attrs:{label:"我发起的"}},[t("div",{staticClass:"no-data"},[e._v("暂无数据 😀")])]),t("el-tab-pane",{attrs:{label:"关于我的"}},[t("div",{staticClass:"no-data"},[e._v("暂无数据 😀")])])],1),t("el-dialog",{attrs:{title:"发起审批",width:"800px",visible:e.openItemDl,"close-on-click-modal":!1},on:{"update:visible":function(t){e.openItemDl=t}}},[e.openItemDl?t("initiate-process",{ref:"processForm",attrs:{code:e.selectForm.formId}}):e._e(),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"mini"},on:{click:function(t){e.openItemDl=!1}}},[e._v("取 消")]),t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.submitForm}},[e._v("提 交")])],1)],1)],1)},a=[],r=n("4e02"),i=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.loading?e._e():t("div",[t("form-render",{ref:"form",staticClass:"process-form",attrs:{forms:e.forms},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}})],1),t("el-divider",[e._v("审批流程")]),t("div",[t("el-alert",{attrs:{type:"warning",description:"开源版后台只是为了演示流程设计功能，后台无法处理流程发起的后续步骤，如需要完整的工作流功能请移步 👉 pro 版本"}}),t("el-link",{attrs:{href:"http://106.13.16.28:83"}},[e._v("访问pro👉 ")]),t("el-timeline",{attrs:{reverse:!1}})],1)],1)},o=[],l=n("2b36"),c=n("d16b"),u={name:"InitiateProcess",components:{FormDesignRender:c["a"],FormRender:l["a"]},props:{code:{type:String,required:!0}},data(){return{loading:!1,formData:{},form:{formId:"",formName:"",logo:{},formItems:[],process:{},remark:""}}},mounted(){this.loadFormInfo(this.code)},computed:{forms(){return this.$store.state.design.formItems}},methods:{loadFormInfo(e){this.loading=!0,Object(r["a"])(e).then(e=>{this.loading=!1,console.log("InitiateProcess",e.data);let t=e.data;t.logo=JSON.parse(t.logo),t.settings=JSON.parse(t.settings),t.formItems=JSON.parse(t.formItems),t.process=JSON.parse(t.process),this.form=t,this.$store.state.design=t}).catch(e=>{this.loading=!1,console.error(e),this.$message.error(e)})},validate(e){this.$refs.form.validate(e)}}},d=u,m=(n("862c"),n("2877")),f=Object(m["a"])(d,i,o,!1,null,"edc9e08a",null),p=f.exports,h={name:"workSpace",components:{InitiateProcess:p},data(){return{openItemDl:!1,selectForm:{},formItem:{},actives:[],formList:{list:[],inputs:"",searchResult:[]},pending:{list:[]}}},mounted(){this.getGroups()},methods:{getGroups(){Object(r["b"])().then(e=>{this.formList.list=e.data,this.formList.list.forEach(e=>{this.actives.push(e.name),e.items.forEach(e=>{e.logo=JSON.parse(e.logo)})}),this.groups=e.data}).catch(e=>this.$message.error("获取分组异常"))},enterItem(e){this.selectForm=e,this.openItemDl=!0},submitForm(){this.$refs.processForm.validate(e=>{e?this.$message.success("表单填写OK了，提交功能还在开发哦"):this.$message.warning("请完善表单😥")})}}},b=h,v=(n("11bb"),Object(m["a"])(b,s,a,!1,null,"39f2f421",null));t["default"]=v.exports},da65:function(e,t,n){}}]);
//# sourceMappingURL=chunk-4594095f.a4d50ba2.js.map