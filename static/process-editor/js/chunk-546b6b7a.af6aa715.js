(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-546b6b7a"],{"35ba":function(e,t,r){},"4ba1":function(e,t,r){"use strict";r("35ba")},"7ca0":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e._self._c;return t("div",["DESIGN"===e.mode?t("div",[t("draggable",{staticClass:"l-drag-from",attrs:{list:e._columns,group:"form",options:{animation:300,chosenClass:"choose",sort:!0}},on:{start:function(t){e.drag=!0,e.selectFormItem=null},end:function(t){e.drag=!1}}},e._l(e._columns,(function(r,s){return t("div",{key:s,staticClass:"l-form-item",style:e.getSelectedClass(r),on:{click:function(t){return t.stopPropagation(),e.selectItem(r)}}},[t("div",{staticClass:"l-form-header"},[t("p",[r.props.required?t("span",[e._v("*")]):e._e(),e._v(e._s(r.title))]),t("div",{staticClass:"l-option"},[t("i",{staticClass:"el-icon-close",on:{click:function(t){return e.delItem(s)}}})]),t("form-design-render",{attrs:{config:r}})],1)])})),0),t("div",{staticStyle:{color:"#c0bebe","text-align":"center",width:"90%",padding:"5px"}},[e._v("☝ 拖拽控件到表格内部")])],1):t("div",[e.rowLayout?t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{size:"medium","header-cell-style":{background:"#f5f7fa",padding:"3px 0"},border:e.showBorder,data:e._value}},[t("el-table-column",{attrs:{fixed:"",type:"index",label:"序号",width:"50"}}),e._l(e._columns,(function(r,s){return t("el-table-column",{attrs:{"min-width":e.getMinWidth(r),prop:r.id,label:r.title},scopedSlots:e._u([{key:"default",fn:function(s){return[t("form-design-render",{class:{"valid-error":e.showError(r,e._value[s.$index][r.id])},attrs:{mode:e.mode,config:r},model:{value:e._value[s.$index][r.id],callback:function(t){e.$set(e._value[s.$index],r.id,t)},expression:"_value[scope.$index][column.id]"}})]}}],null,!0)})})),t("el-table-column",{attrs:{fixed:"right","min-width":"90",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.copyData(r.$index,r.row)}}},[e._v("复制")]),t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){return e.delRow(r.$index,r.row)}}},[e._v("删除")])]}}],null,!1,3573095417)})],2),t("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v(e._s(e.placeholder))])],1):t("div",[e._l(e._value,(function(r,s){return t("el-form",{key:s,ref:"table-form-"+s,refInFor:!0,staticClass:"table-column",attrs:{rules:e.rules,model:r}},[t("div",{staticClass:"table-column-action"},[t("span",[e._v("第 "+e._s(s+1)+" 项")]),t("i",{staticClass:"el-icon-close",on:{click:function(t){return e.delRow(s,r)}}})]),e._l(e._columns,(function(s,a){return t("el-form-item",{key:"column_"+a,attrs:{prop:s.id,label:s.title}},[t("form-design-render",{attrs:{mode:e.mode,config:s},model:{value:r[s.id],callback:function(t){e.$set(r,s.id,t)},expression:"row[column.id]"}})],1)}))],2)})),t("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v(e._s(e.placeholder))])],2)])])},a=[],i=(r("14d9"),r("b76a")),l=r.n(i),n=r("8032"),o=r("d16b"),u=r("8f73"),c={mixins:[u["a"]],name:"TableList",components:{draggable:l.a,FormDesignRender:o["a"]},props:{value:{type:Array,default:()=>[]},placeholder:{type:String,default:"添加数据"},columns:{type:Array,default:()=>[]},showBorder:{type:Boolean,default:!0},maxSize:{type:Number,default:0},rowLayout:{type:Boolean,default:!0}},created(){Array.isArray(this.value)||(this._value=[])},computed:{rules(){const e={};return this.columns.forEach(t=>{t.props.required&&(e[t.id]=[{type:"Array"===t.valueType?"array":void 0,required:!0,message:"请填写"+t.title,trigger:"blur"}])}),e},_columns:{get(){return this.columns},set(e){this.columns=e}},selectFormItem:{get(){return this.$store.state.selectFormItem},set(e){this.$store.state.selectFormItem=e}}},data(){return{select:null,drag:!1,ValueType:n["a"]}},methods:{getMinWidth(e){switch(e.name){case"DateTime":return"250px";case"DateTimeRange":return"280px";case"MultipleSelect":return"200px";default:return"150px"}},showError(e,t){if(e.props.required)switch(e.valueType){case n["a"].dept:case n["a"].user:case n["a"].dateRange:case n["a"].array:return!(Array.isArray(t)&&t.length>0);default:return!this.$isNotEmpty(t)}return!1},copyData(e,t){this._value.push(this.$deepCopy(t))},delRow(e,t){this._value.splice(e,1)},addRow(){if(this.maxSize>0&&this._value.length>=this.maxSize)this.$message.warning(`最多只能添加${this.maxSize}行`);else{let e={};this.columns.forEach(t=>this.$set(e,t.id,void 0)),this._value.push(e),this.$set(this,"_value",this._value)}},delItem(e){this._columns.splice(e,1)},selectItem(e){this.selectFormItem=e},getSelectedClass(e){return this.selectFormItem&&this.selectFormItem.id===e.id?"border-left: 4px solid #f56c6c":""},validate(e){if(this.rowLayout){let t=!0;for(let r=0;r<this.columns.length;r++)if(this.columns[r].props.required)for(let s=0;s<this._value.length;s++)if(t=!this.showError(this.columns[r],this._value[s][this.columns[r].id]),!t)return void e(!1);e(t)}else{let t=0;this._value.forEach((e,r)=>{let s=this.$refs["table-form-"+r];s&&Array.isArray(s)&&s.length>0&&s[0].validate(e=>{e&&t++})}),t===this._value.length?e(!0):e(!1)}}}},d=c,m=(r("4ba1"),r("2877")),p=Object(m["a"])(d,s,a,!1,null,"0f04320c",null);t["default"]=p.exports},8032:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));const s={string:"String",object:"Object",array:"Array",number:"Number",date:"Date",user:"User",dept:"Dept",dateRange:"DateRange"};s.array,s.string,s.string,s.number,s.number,s.string,s.array,s.date,s.dateRange,s.array,s.array,s.user,s.dept,s.string,s.array},"8f73":function(e,t,r){"use strict";t["a"]={props:{mode:{type:String,default:"DESIGN"},required:{type:Boolean,default:!1}},data(){return{}},computed:{_value:{get(){return this.value},set(e){this.$emit("input",e)}}}}}}]);
//# sourceMappingURL=chunk-546b6b7a.af6aa715.js.map